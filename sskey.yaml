---
# file: exchange_ssh_keys/tasks/main.yml

- block:

    - name: "Get public key file"
      fetch:
        src: "/home/reramana/.ssh/id_rsa.pub"
        dest: "/var/tmp/reramana_id_rsa.pub"
        flat: yes

  # block end
  #when: hc4t05928.itcs.hpecorp.net
  when: inventory_hostname in groups['source_group']
  become: yes
  become_user: root
  tags: exchange_ssh_keys


- block:

    - name: "Push public key file"
      copy:
        src: "/var/tmp/reramana_id_rsa.pub"
        dest: "/var/tmp/reramana_id_rsa.pub"
      #with_items: inventory_hostname in groups['source_group']

    - name: "copy files to reramana"
      copy:
        src: "/var/tmp/reramana_id_rsa.pub"
        dest: "/home/reramana/.ssh/id_rsa.pub"

  # block end
  become: true
  become_user: root
  #when: hc4t05929.itcs.hpecorp.net
  #when: inventory_hostname in groups['dest_group']
  tags: exchange_ssh_keys


- block:

    - name: "Get public key file"
      fetch:
        src: "/home/reramana/.ssh/id_rsa"
        dest: "/var/tmp/reramana_id_rsa"
        flat: yes

  # block end
  #when: hc4t05928.itcs.hpecorp.net
  when: inventory_hostname in groups['source_group']
  become: yes
  become_user: root
  tags: exchange_ssh_keys


- block:

    - name: "Push public key file"
      copy:
        src: "/var/tmp/reramana_id_rsa"
        dest: "/var/tmp/reramana_id_rsa"
      #with_items: inventory_hostname in groups['source_group']

    - name: "copy files to reramana"
      copy:
        src: "/var/tmp/reramana_id_rsa"
        dest: "/home/reramana/.ssh/id_rsa"

  # block end
  become: true
  become_user: root
  #when: hc4t05929.itcs.hpecorp.net
  #when: inventory_hostname in groups['dest_group']
  tags: exchange_ssh_keys  
  
- block:

    - name: "Get public key file"
      fetch:
        src: "/home/reramana/.ssh/authorized_keys"
        dest: "/var/tmp/reramana_authorized_keys"
        flat: yes

  # block end
  #when: hc4t05928.itcs.hpecorp.net
  when: inventory_hostname in groups['source_group']
  become: yes
  become_user: root
  tags: exchange_ssh_keys


- block:

    - name: "Push public key file"
      copy:
        src: "/var/tmp/reramana_authorized_keys"
        dest: "/var/tmp/reramana_authorized_keys"
      #with_items: inventory_hostname in groups['source_group']

    - name: "copy files to reramana"
      copy:
        src: "/var/tmp/reramana_authorized_keys"
        dest: "/home/reramana/.ssh/authorized_keys"

  # block end
  become: true
  become_user: root
  #when: hc4t05929.itcs.hpecorp.net
  #when: inventory_hostname in groups['dest_group']
  tags: exchange_ssh_keys  
 
